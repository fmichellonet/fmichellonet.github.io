<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Project Template, Quickstart et VSIX</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css@v=cbcfaedfc4.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/prism.css@v=cbcfaedfc4.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="mymemoryleaks" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Project Template, Quickstart et VSIX" />
    <meta property="og:description" content="Dernièrement j’ai fait mumuse avec les template de fichiers et projets que l’on peut créer dans Visual Studio. Pour ceux qui ne connaissent pas, les template de fichier vous permettent de définir l’ossature d’un type de fichier que vous utilisez souvent. Une fois créé vous retrouverez" />
    <meta property="og:url" content="http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/" />
    <meta property="article:published_time" content="2011-05-13T21:29:00.000Z" />
    <meta property="article:modified_time" content="2011-05-13T21:29:00.000Z" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Project Template, Quickstart et VSIX" />
    <meta name="twitter:description" content="Dernièrement j’ai fait mumuse avec les template de fichiers et projets que l’on peut créer dans Visual Studio. Pour ceux qui ne connaissent pas, les template de fichier vous permettent de définir l’ossature d’un type de fichier que vous utilisez souvent. Une fois créé vous retrouverez" />
    <meta name="twitter:url" content="http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Fabrice Michellonet" />
    <meta name="twitter:site" content="@mymemoryleaks" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "mymemoryleaks",
        "logo": "http://www.mymemoryleaks.fr/content/images/2018/03/mosquito.png"
    },
    "author": {
        "@type": "Person",
        "name": "Fabrice Michellonet",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/65244b78c89aff8f81952bd8a452ac0a?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://www.mymemoryleaks.fr/author/fabrice/",
        "sameAs": []
    },
    "headline": "Project Template, Quickstart et VSIX",
    "url": "http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/",
    "datePublished": "2011-05-13T21:29:00.000Z",
    "dateModified": "2011-05-13T21:29:00.000Z",
    "description": "Dernièrement j’ai fait mumuse avec les template de fichiers et projets que l’on peut créer dans Visual Studio. Pour ceux qui ne connaissent pas, les template de fichier vous permettent de définir l’ossature d’un type de fichier que vous utilisez souvent. Une fois créé vous retrouverez",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.mymemoryleaks.fr/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js@v=cbcfaedfc4"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "a44cbdccbe24"
});
</script>
    <meta name="generator" content="Ghost 1.21" />
    <link rel="alternate" type="application/rss+xml" title="mymemoryleaks" href="../rss/index.html" />
</head>
<body class="post-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home"><a href="../index.html">Home</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="../rss/index.html">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <div class="main-header-background-square"></div>
    <nav class="main-nav  clearfix">
        <a class="blog-logo" href="../index.html"><img src="../content/images/2018/03/mosquito.png" alt="mymemoryleaks" /></a>
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Project Template, Quickstart et VSIX</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2011-05-13">13 May 2011</time> 
            </section>
        </header>

        <section class="post-content">
            <div class="kg-card-markdown"><p>Dernièrement j’ai fait mumuse avec les template de fichiers et projets que l’on peut créer dans Visual Studio.</p>
<p><img src="http://fabrice.michellonet.free.fr/MyMemoryLeaks/Posts/41/coccinelle.png" alt="coccinelle"></p>
<p>Pour ceux qui ne connaissent pas, les template de fichier vous permettent de définir l’ossature d’un type de fichier que vous utilisez souvent. Une fois créé vous retrouverez votre template dans le menu de Visual Studio « Add new Item ».</p>
<p>Par extension les projects template vous permettent de définir la structure d’un type projet, afin de prendre en compte les conventions de votre équipe par exemple. Vous y définissez l’ensemble des fichiers présent dès la création du projet.</p>
<p>Ce qui est très intéressant, c'est que cela permet d'avoir des projets prêts à l'emploi dans votre environnement, avec par exemple <a href="http://nlog-project.org/">NLog</a> <a href="http://www.blogger.com/post-create.g?blogID=1146316188254265608">et votre conteneur </a> <a href="http://martinfowler.com/articles/injection.html">DI</a> <a href="http://www.castleproject.org/">préféré</a>. Si vous êtes expérimenté cela vous évitera quelques copier-coller, si par contre vous ne connaissez pas bien une des briques technique cela vous évitera un tas de problématique.</p>
<p>Quoi qu'il en soit voici quelques astuces sur ces templates :</p>
<ol>
<li>Bien que le <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=21307c23-f0ff-4ef2-a0a4-dca54ddb1e21">SDK</a> de Visual Studio vous propose des projets de type Item Template et Project Template, le plus simple reste d’utiliser le menu File -&gt; Export Template de Viual Studio pour générer votre précieux template.</li>
<li>Pour créer un quickstart, qui n’est autre qu’un template de solution (plusieurs projets), je vous conseille de :</li>
<li>Exporter vos différents projets template et extraire les archives zip correspondante dans un même dossier.</li>
<li>Ajouter dans ce dossier de travail un fichier .vstemplate reprenant cette structure<br>
<VSTemplate Version="2.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="ProjectGroup"> <TemplateData> <Name>Ma solution</Name> <Description>Ma description</Description> <ProjectType>CSharp</ProjectType> <ProjectSubType></ProjectSubType> <SortOrder>1000</SortOrder> <CreateNewFolder>false</CreateNewFolder> <LocationField>Enabled</LocationField> <EnableLocationBrowseButton>true</EnableLocationBrowseButton> <Icon>monicone_100x100.ico</Icon> </TemplateData> <TemplateContent> <ProjectCollection> <ProjectTemplateLink ProjectName="Web"> WebMyTemplate.vstemplate </ProjectTemplateLink> <ProjectTemplateLink ProjectName="Domain"> DomainMyTemplate.vstemplate </ProjectTemplateLink> <ProjectTemplateLink ProjectName="DAL"> DALMyTemplate.vstemplate </ProjectTemplateLink> <ProjectTemplateLink ProjectName="IServices"> IServicesMyTemplate.vstemplate </ProjectTemplateLink> <ProjectTemplateLink ProjectName="Services"> ServicesMyTemplate.vstemplate </ProjectTemplateLink> </ProjectCollection> </TemplateContent> </VSTemplate></li>
</ol>
<p>Vous pouvez y mettre autant de référence a des projects que vous le souhaitez en ajoutant des balises ProjectTemplateLink.</p>
<ol start="7">
<li>
<p>Créez une archive zip du dossier de travail et placez la dans le dossier %VSInstallDir%Common7IDEProjectTemplates. Après redémarrage de Visual Studio le nouveau template sera dispo.</p>
</li>
<li>
<p>Dans le fichier vstemplate de votre Quickstart, la première occurrence à un projet sera par convention le startup project.</p>
</li>
<li>
<p>Pour étendre avec du code custom vos project template il vous faudra :</p>
</li>
<li>
<p>Créer une assembly et implémenter l’interface <a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.templatewizard.iwizard%28v=VS.100%29.aspx">Microsoft.VisualStudio.TemplateWizard.IWizard</a></p>
</li>
<li>
<p>Ajouter la balise WizardExtension dans le fichier .vstemplate de votre project template<br>
<VSTemplate Version="3.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="Project"> … <WizardExtension> <Assembly>MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=952e5fc020f3b126</Assembly> <FullClassName>MyAssembly.Wizard</FullClassName> </WizardExtension> </VSTemplate></p>
</li>
<li>
<p>Il est possible de faire appel à une assembly custom dans un template de type quickstart, mais attention, la plupart des appels que vous ferez sur les objects EnvDTE et plus particulièrement <a href="http://msdn.microsoft.com/en-us/library/envdte.project.aspx">EnvDTE.Project</a> fréquemment utilisés dans la méthode <a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.templatewizard.iwizard.projectitemfinishedgenerating.aspx">IWizard. ProjectFinishedGenerating</a> vous renverront des valeurs nulles.</p>
</li>
<li>
<p>La façon la plus simple de créer un VSIX de déploiement est d’utiliser le projet de type VSIX Project (Visual C# -&gt; Extensibility -&gt; VSIX Project). Le <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=21307c23-f0ff-4ef2-a0a4-dca54ddb1e21">SDK</a> doit être installé.</p>
</li>
<li>
<p>Dans le designer de VSIX, le champ ID comporte un GUID… n’y touchez surtout pas !</p>
</li>
<li>
<p>Il est possible de définir dans quelle catégorie de template se trouvera l’élément que vous déployez via votre VSIX en renseignant le champ Add to subfolder.<br>
<img src="http://fabrice.michellonet.free.fr/MyMemoryLeaks/Posts/41/subfolder.png" alt="subfolder"></p>
</li>
</ol>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/fabrice/index.html" style="background-image: url(http://www.gravatar.com/avatar/65244b78c89aff8f81952bd8a452ac0a?s&)"><span class="hidden">Fabrice Michellonet's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/fabrice/index.html">Fabrice Michellonet</a></h4>

                    <p>Read <a href="../author/fabrice/index.html">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Project%20Template%2C%20Quickstart%20et%20VSIX&amp;url=http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>
        <div id="disqus_thread"></div>
    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../quickstart-nuget/index.html">
        <section class="post">
            <h2>Quickstart &amp; Nuget</h2>
            <p>Dans mon précédent post j’effleurais le sujet des gains de productivité que pouvais procurer les templates et autres&hellip;</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../quickstart-telerik-extensions-for-asp-net-mvc-via-nuget/index.html">
        <section class="post">
            <h2>Quickstart Telerik Extensions for ASP.NET MVC via Nuget</h2>
            <p>Sans nul doute Nuget a grandement amélioré le process de déploiement/configuration/utilisation de bibliothèques tierces dans l'écosystème .NET.&hellip;</p>
        </section>
    </a>
</aside>



<script>
var disqus_config = function () {
this.page.url = 'http://www.mymemoryleaks.fr/project-template-quickstart-et-vsix/';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'ghost-43'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://www-mymemoryleaks-fr.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="../index.html">mymemoryleaks</a> &copy; 2018</section>
            <section class="poweredby">Powered by <a href="http://boo-demo.tenoku.com/">Ghost + Boo</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js@v=cbcfaedfc4"></script>
    <script type="text/javascript" src="../assets/js/index.js@v=cbcfaedfc4"></script>
    <script type="text/javascript" src="../assets/js/prism.js@v=cbcfaedfc4"></script>
    <script src="https://cdn.jsdelivr.net/mobile-detect.js/1.3.3/mobile-detect.min.js"></script>
    <script src="https://npmcdn.com/imagesloaded@4.1/imagesloaded.pkgd.min.js"></script>

</body>
</html>
